<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>College Connect - KKWIEER</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
  <style>
    /* Custom animations */
    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .animate-slide-in {
      animation: slideIn 0.5s ease-out forwards;
    }

    .animate-fade-in {
      animation: fadeIn 0.3s ease-in forwards;
    }

    /* Smooth hover effect for buttons */
    .btn-hover {
      transition: all 0.3s ease-in-out;
    }

    .btn-hover:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    /* Card hover effect */
    .card-hover {
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .card-hover:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
    }

    /* Modal animation */
    .modal-content {
      animation: slideIn 0.3s ease-out;
    }

    /* Fancy title font */
    .fancy-title {
      font-family: 'Dancing Script', cursive;
      font-weight: 700;
    }
  </style>
</head>
<body class="bg-gradient-to-b from-gray-50 to-gray-200 text-gray-800 font-sans min-h-screen">

  <!-- Header -->
  <header class="bg-gradient-to-r from-indigo-700 to-indigo-900 text-white py-8 shadow-lg mb-10">
    <div class="max-w-5xl mx-auto px-4 animate-slide-in">
      <h1 class="text-5xl font-extrabold mb-2 tracking-tight fancy-title">College Connect</h1>
      <p class="text-xl font-light opacity-90">KKWIEER's Community Platform to Connect Students and Faculty</p>
    </div>
  </header>

  <!-- Blog / Introduction Section -->
  <section class="max-w-5xl mx-auto px-4 mb-12 animate-slide-in">
    <div class="bg-white p-8 rounded-xl shadow-xl border-l-4 border-indigo-600 transform transition-all duration-500 hover:shadow-2xl">
      <h2 class="text-3xl font-semibold mb-4 text-indigo-700">About College Connect</h2>
      <p class="text-gray-600 text-lg leading-relaxed">
        College Connect is a collaborative platform created exclusively for the students and faculty members of <strong>KKWIEER</strong>. 
        Our goal is to foster better communication, discovery, and collaboration within our academic community.
        <br/><br/>
        Students can create rich profiles highlighting their interests, expertise, and academic background, while faculty members can showcase their research fields, departmental roles, and areas of specialization.
        <br/><br/>
        With built-in search, branch filtering, and personalized login, College Connect helps you explore your peers, discover common interests, and build meaningful connections — whether you're looking for project collaborators, mentors, or simply to know more about your college community.
        <br/><br/>
        Welcome to a smarter, more connected KKWIEER!
      </p>
    </div>
  </section>

  <!-- Login -->
  <main class="max-w-5xl mx-auto px-4">
    <div id="loginSection" class="bg-white p-8 rounded-xl shadow-lg mb-8 animate-slide-in">
      <h2 class="text-3xl font-semibold mb-6 text-gray-800">Login</h2>
      <input id="loginName" placeholder="Enter Full Name (e.g., John Michael Doe)" class="border border-gray-300 p-3 rounded-lg w-full mb-4 focus:ring-2 focus:ring-indigo-500 focus:outline-none transition-all duration-300"/>
      <select id="userType" class="border border-gray-300 p-3 rounded-lg w-full mb-4 focus:ring-2 focus:ring-indigo-500 focus:outline-none transition-all duration-300">
        <option value="student">Student</option>
        <option value="staff">Staff</option>
      </select>
      <button onclick="loginUser()" class="bg-green-500 text-white px-6 py-3 rounded-lg w-full font-medium btn-hover">Login</button>
    </div>

    <!-- Profile Form -->
    <form id="profileForm" class="bg-white p-8 rounded-xl shadow-lg mb-8 hidden animate-slide-in">
      <div id="studentFields" class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <input id="father" placeholder="Father's Name" class="border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none transition-all duration-300"/>
        <input id="mother" placeholder="Mother's Name" class="border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none transition-all duration-300" required/>
        <input id="year" placeholder="College Year" class="border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none transition-all duration-300" required/>
        <input id="division" placeholder="Division" class="border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none transition-all duration-300" required/>
        <input id="roll" placeholder="Roll Number" class="border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none transition-all duration-300" required/>
        <input id="contact" placeholder="Contact Number" class="border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none transition-all duration-300" required/>
        <input id="branch" placeholder="Branch (Civil/Computer Engineering)" class="border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none transition-all duration-300" required/>
        <input id="interests" placeholder="Interests (comma separated)" class="border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none transition-all duration-300" required/>
        <input id="expertise" placeholder="Expertise" class="border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none transition-all duration-300" required/>
        <input id="experience" placeholder="Experience" class="border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none transition-all duration-300" required/>
      </div>

      <div id="staffFields" class="grid grid-cols-1 md:grid-cols-2 gap-4 hidden">
        <input id="staffExpertise" placeholder="Expertise" class="border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none transition-all duration-300" required/>
        <input id="research" placeholder="Field of Research" class="border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none transition-all duration-300" required/>
        <input id="location" placeholder="Sitting Location" class="border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none transition-all duration-300" required/>
        <input id="staffBranch" placeholder="Department" class="border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none transition-all duration-300" required/>
        <input id="staffContact" placeholder="Phone Number" class="border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:outline-none transition-all duration-300" required/>
      </div>

      <div class="mt-6 flex gap-3">
        <button id="saveButton" type="button" onclick="saveProfile()" class="bg-blue-600 text-white px-6 py-3 rounded-lg font-medium btn-hover">Save Profile</button>
        <button type="button" onclick="logoutUser()" class="bg-red-500 text-white px-6 py-3 rounded-lg font-medium btn-hover">Logout</button>
      </div>
    </form>

    <!-- Search - Hidden by default -->
    <div id="searchSection" class="hidden animate-slide-in">
      <input oninput="renderProfiles()" id="search" placeholder="Search by name or interest..." class="border border-gray-300 p-3 rounded-lg w-full mb-6 focus:ring-2 focus:ring-indigo-500 focus:outline-none transition-all duration-300"/>
    </div>

    <!-- Profiles List - Hidden by default -->
    <div id="profilesSection" class="hidden animate-slide-in">
      <h2 class="text-2xl font-semibold mb-4 text-gray-800">All Profiles</h2>
      <div id="profiles" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12"></div>
    </div>

    <!-- Profile Detail Modal -->
    <div id="profileModal" class="fixed inset-0 bg-black bg-opacity-60 hidden items-center justify-center z-50 transition-opacity duration-300">
      <div class="bg-white p-8 rounded-xl max-w-lg w-full mx-4 max-h-[80vh] overflow-y-auto modal-content shadow-2xl">
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-2xl font-bold text-gray-800">Profile Details</h3>
          <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700 text-3xl transition-colors duration-200">×</button>
        </div>
        <div id="modalContent" class="text-gray-700"></div>
      </div>
    </div>
  </main>

  <!-- JavaScript Logic -->
  <script>
    // Initialize DOM elements
    const loginNameInput = document.getElementById("loginName");
    const userTypeSelect = document.getElementById("userType");
    const profileForm = document.getElementById("profileForm");
    const studentFields = document.getElementById("studentFields");
    const staffFields = document.getElementById("staffFields");
    const searchInput = document.getElementById("search");
    const profilesContainer = document.getElementById("profiles");
    const loginSection = document.getElementById("loginSection");
    const searchSection = document.getElementById("searchSection");
    const profilesSection = document.getElementById("profilesSection");
    const profileModal = document.getElementById("profileModal");
    const modalContent = document.getElementById("modalContent");

    // Data storage
    let currentUser = null;
    let users = [];

    // Load users from localStorage on page load
    function loadUsersFromStorage() {
      const storedUsers = localStorage.getItem('collegeConnectUsers');
      if (storedUsers) {
        users = JSON.parse(storedUsers);
      } else {
        users = [];
      }
      console.log("Loaded users from localStorage:", users);
      renderProfiles();
    }

    // Save users to localStorage
    function saveUsersToStorage() {
      localStorage.setItem('collegeConnectUsers', JSON.stringify(users));
      console.log("Saved users to localStorage:", users);
    }

    // Login function
    function loginUser() {
      const name = loginNameInput.value.trim();
      const type = userTypeSelect.value;

      console.log("Login attempt:", { name, type });

      if (!name) {
        alert("Please enter your full name.");
        return;
      }

      if (type === "student" && name.split(" ").length < 3) {
        alert("Please enter your full name in 'Name Father's Name Surname' format.");
        return;
      }

      currentUser = { name, type };
      console.log("User logged in:", currentUser);
      
      loginSection.style.display = "none";
      profileForm.classList.remove("hidden");
      searchSection.classList.remove("hidden");
      profilesSection.classList.remove("hidden");
      
      showFormFields(type);
      populateForm();
      renderProfiles();
    }

    // Logout function
    function logoutUser() {
      currentUser = null;
      
      loginSection.style.display = "block";
      profileForm.classList.add("hidden");
      searchSection.classList.add("hidden");
      profilesSection.classList.add("hidden");
      
      profileForm.reset();
      searchInput.value = "";
      loginNameInput.value = "";
      userTypeSelect.value = "student";
      
      console.log("User logged out");
    }

    // Show appropriate form fields based on user type
    function showFormFields(type) {
      if (type === "student") {
        studentFields.classList.remove("hidden");
        staffFields.classList.add("hidden");
      } else {
        studentFields.classList.add("hidden");
        staffFields.classList.remove("hidden");
      }
    }

    // Fill the form with existing user data
    function populateForm() {
      if (!currentUser) return;
      
      const u = users.find(u => u.name === currentUser.name);
      if (!u) return;

      if (currentUser.type === "student") {
        document.getElementById("father").value = u.father || "";
        document.getElementById("mother").value = u.mother || "";
        document.getElementById("year").value = u.year || "";
        document.getElementById("division").value = u.division || "";
        document.getElementById("roll").value = u.roll || "";
        document.getElementById("contact").value = u.contact || "";
        document.getElementById("branch").value = u.branch || "";
        document.getElementById("interests").value = u.interests ? u.interests.join(", ") : "";
        document.getElementById("expertise").value = u.expertise || "";
        document.getElementById("experience").value = u.experience || "";
      } else {
        document.getElementById("staffExpertise").value = u.expertise || "";
        document.getElementById("research").value = u.research || "";
        document.getElementById("location").value = u.location || "";
        document.getElementById("staffBranch").value = u.branch || "";
        document.getElementById("staffContact").value = u.contact || "";
      }
    }

    // Handle profile form submission
    profileForm.addEventListener("submit", function (e) {
      e.preventDefault();
      saveProfile();
    });

    // Save profile data
    function saveProfile() {
      if (!currentUser) {
        alert("You must be logged in to save a profile!");
        return;
      }
      
      const type = currentUser.type;
      let user = { name: currentUser.name, type };

      if (type === "student") {
        user.father = document.getElementById("father").value || "";
        user.mother = document.getElementById("mother").value || "";
        user.year = document.getElementById("year").value || "";
        user.division = document.getElementById("division").value || "";
        user.roll = document.getElementById("roll").value || "";
        user.contact = document.getElementById("contact").value || "";
        user.branch = document.getElementById("branch").value || "";
        const interestsString = document.getElementById("interests").value || "";
        user.interests = interestsString.toLowerCase().split(",").map(i => i.trim()).filter(i => i);
        user.expertise = document.getElementById("expertise").value || "";
        user.experience = document.getElementById("experience").value || "";
      } else {
        user.expertise = document.getElementById("staffExpertise").value || "";
        user.research = document.getElementById("research").value || "";
        user.location = document.getElementById("location").value || "";
        user.branch = document.getElementById("staffBranch").value || "";
        user.contact = document.getElementById("staffContact").value || "";
      }

      const index = users.findIndex(u => u.name === currentUser.name);      
      if (index >= 0) {
        users[index] = user;
      } else {
        users.push(user);
      }
      
      // Save to localStorage
      saveUsersToStorage();
      
      console.log("Profile saved:", user);
      renderProfiles();
      alert("Profile saved successfully!");
    }

    // Render all profiles based on search
    function renderProfiles() {
      const search = searchInput.value.toLowerCase();
      profilesContainer.innerHTML = "";

      const filteredUsers = users.filter(u => 
        u.name.toLowerCase().includes(search) || 
        (u.interests && u.interests.some(interest => interest.toLowerCase().includes(search)))
      );

      filteredUsers.forEach((u, index) => {
        const card = document.createElement("div");
        card.className = `p-6 rounded-xl shadow-lg card-hover ${u.type === 'staff' ? 'bg-green-100 border-l-4 border-green-600' : 'bg-blue-100 border-l-4 border-blue-600'} animate-slide-in`;
        card.style.animationDelay = `${index * 0.1}s`;
        
        const isCurrentUser = currentUser && currentUser.name === u.name;
        
        card.innerHTML = `
          <h3 class="text-xl font-bold text-gray-800 mb-3">${u.name}</h3>
          ${u.type === "student" ? `
            <p class="text-gray-600"><strong>Year:</strong> ${u.year || 'Not provided'}</p>
            <p class="text-gray-600"><strong>Division:</strong> ${u.division || 'Not provided'}</p>
            <p class="text-gray-600"><strong>Roll No:</strong> ${u.roll || 'Not provided'}</p>
            <p class="text-gray-600"><strong>Contact:</strong> ${u.contact ? '***-***-****' : 'Not provided'}</p>
            <p class="text-gray-600"><strong>Branch:</strong> ${u.branch || 'Not provided'}</p>
            <p class="text-gray-600"><strong>Interests:</strong> ${u.interests ? u.interests.join(', ') : 'Not provided'}</p>
            <p class="text-gray-600"><strong>Expertise:</strong> ${u.expertise || 'Not provided'}</p>
            <p class="text-gray-600"><strong>Experience:</strong> ${u.experience || 'Not provided'}</p>
          ` : `
            <p class="text-gray-600"><strong>Department:</strong> ${u.branch || 'Not provided'}</p>
            <p class="text-gray-600"><strong>Expertise:</strong> ${u.expertise || 'Not provided'}</p>
            <p class="text-gray-600"><strong>Research:</strong> ${u.research || 'Not provided'}</p>
            <p class="text-gray-600"><strong>Location:</strong> ${u.location || 'Not provided'}</p>
            <p class="text-gray-600"><strong>Contact:</strong> ${u.contact ? '***-***-****' : 'Not provided'}</p>
          `}
          <div class="mt-4 flex gap-3">
            <button onclick="connectProfile('${u.name}')" class="bg-purple-500 text-white px-4 py-2 rounded-lg text-sm font-medium btn-hover">Connect</button>
            ${isCurrentUser ? `
              <button onclick="editProfile('${u.name}')" class="bg-blue-500 text-white px-4 py-2 rounded-lg text-sm font-medium btn-hover">Edit</button>
              <button onclick="deleteProfile('${u.name}')" class="bg-red-500 text-white px-4 py-2 rounded-lg text-sm font-medium btn-hover">Delete</button>
            ` : ''}
          </div>
        `;
        profilesContainer.appendChild(card);
      });
    }

    // Connect to a profile - Opens modal with full details
    function connectProfile(name) {
      const user = users.find(u => u.name === name);
      if (!user) return;

      modalContent.innerHTML = `
        <div class="space-y-4 animate-fade-in">
          <h4 class="text-xl font-bold text-center text-gray-800">${user.name}</h4>
          <div class="border-t pt-4">
            ${user.type === "student" ? `
              <p class="text-gray-600"><strong>Type:</strong> Student</p>
              <p class="text-gray-600"><strong>Father's Name:</strong> ${user.father || 'Not provided'}</p>
              <p class="text-gray-600"><strong>Mother's Name:</strong> ${user.mother || 'Not provided'}</p>
              <p class="text-gray-600"><strong>Year:</strong> ${user.year || 'Not provided'}</p>
              <p class="text-gray-600"><strong>Division:</strong> ${user.division || 'Not provided'}</p>
              <p class="text-gray-600"><strong>Roll No:</strong> ${user.roll || 'Not provided'}</p>
              <p class="text-gray-600"><strong>Contact:</strong> ${user.contact || 'Not provided'}</p>
              <p class="text-gray-600"><strong>Branch:</strong> ${user.branch || 'Not provided'}</p>
              <p class="text-gray-600"><strong>Interests:</strong> ${user.interests ? user.interests.join(', ') : 'Not provided'}</p>
              <p class="text-gray-600"><strong>Expertise:</strong> ${user.expertise || 'Not provided'}</p>
              <p class="text-gray-600"><strong>Experience:</strong> ${user.experience || 'Not provided'}</p>
            ` : `
              <p class="text-gray-600"><strong>Type:</strong> Staff</p>
              <p class="text-gray-600"><strong>Department:</strong> ${user.branch || 'Not provided'}</p>
              <p class="text-gray-600"><strong>Expertise:</strong> ${user.expertise || 'Not provided'}</p>
              <p class="text-gray-600"><strong>Research:</strong> ${user.research || 'Not provided'}</p>
              <p class="text-gray-600"><strong>Location:</strong> ${user.location || 'Not provided'}</p>
              <p class="text-gray-600"><strong>Contact:</strong> ${user.contact || 'Not provided'}</p>
            `}
          </div>
        </div>
      `;
      
      profileModal.classList.remove("hidden");
      profileModal.classList.add("flex");
    }

    // Close modal
    function closeModal() {
      profileModal.classList.add("hidden");
      profileModal.classList.remove("flex");
    }

    // Close modal when clicking outside
    profileModal.addEventListener('click', function(e) {
      if (e.target === profileModal) {
        closeModal();
      }
    });

    // Edit a profile
    function editProfile(name) {
      const user = users.find(u => u.name === name);
      if (user) {
        currentUser = { name, type: user.type };
        loginSection.style.display = "none";
        profileForm.classList.remove("hidden");
        searchSection.classList.remove("hidden");
        profilesSection.classList.remove("hidden");
        showFormFields(user.type);
        populateForm();
      }
    }

    // Delete a profile
    function deleteProfile(name) {
      if (confirm("Are you sure you want to delete this profile?")) {
        users = users.filter(u => u.name !== name);
        
        // Save updated users to localStorage
        saveUsersToStorage();
        
        if (currentUser && currentUser.name === name) {
          logoutUser();
        } else {
          renderProfiles();
        }
      }
    }

    // Initialize - Load users from localStorage
    loadUsersFromStorage();
    console.log("App initialized");
  </script>
</body>
</html>
