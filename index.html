<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>College Connect</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-6">
  <div class="max-w-5xl mx-auto">
    <h1 class="text-3xl font-bold mb-6 text-center">College Connect</h1>

    <!-- Login Section -->
    <div id="loginSection" class="bg-white p-6 rounded shadow mb-6">
      <h2 class="text-xl font-semibold mb-4">Login</h2>
      <input type="text" id="loginName" placeholder="Full Name (Name Father's Name Surname for students)" class="border p-2 rounded w-full mb-3" />
      <select id="userRole" class="border p-2 rounded w-full mb-3">
        <option value="student">Student</option>
        <option value="staff">Staff</option>
      </select>
      <button onclick="loginUser()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Login</button>
    </div>

    <!-- Student Profile Form -->
    <form id="studentForm" class="bg-white p-6 rounded shadow mb-6 hidden">
      <h2 class="text-xl font-semibold mb-4">Student Profile</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <input type="text" placeholder="College Year" id="year" class="border p-2 rounded" required />
        <input type="text" placeholder="Division" id="division" class="border p-2 rounded" required />
        <input type="text" placeholder="Roll Number" id="roll" class="border p-2 rounded" required />
        <input type="text" placeholder="Contact Number" id="contact" class="border p-2 rounded" required />
        <input type="text" placeholder="Interests (comma separated)" id="interests" class="border p-2 rounded" required />
        <input type="text" placeholder="Expertise" id="expertise" class="border p-2 rounded" required />
        <input type="text" placeholder="Experience" id="experience" class="border p-2 rounded" required />
        <input type="text" placeholder="Mother's Name" id="mother" class="border p-2 rounded" required />
        <select id="branch" class="border p-2 rounded">
          <option value="Civil Engineering">Civil Engineering</option>
          <option value="Computer Engineering">Computer Engineering</option>
        </select>
      </div>
      <div class="mt-4">
        <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Save Profile</button>
        <button type="button" onclick="logoutUser()" class="ml-4 bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">Logout</button>
      </div>
    </form>

    <!-- Staff Profile Form -->
    <form id="staffForm" class="bg-white p-6 rounded shadow mb-6 hidden">
      <h2 class="text-xl font-semibold mb-4">Staff Profile</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <input type="text" placeholder="Expertise" id="staffExpertise" class="border p-2 rounded" required />
        <input type="text" placeholder="Field of Research" id="fieldResearch" class="border p-2 rounded" required />
        <input type="text" placeholder="Sitting Location" id="sittingLocation" class="border p-2 rounded" required />
        <input type="text" placeholder="Phone Number" id="staffPhone" class="border p-2 rounded" required />
        <select id="staffDept" class="border p-2 rounded">
          <option value="Civil Engineering">Civil Engineering</option>
          <option value="Computer Engineering">Computer Engineering</option>
        </select>
      </div>
      <div class="mt-4">
        <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Save Profile</button>
        <button type="button" onclick="logoutUser()" class="ml-4 bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">Logout</button>
      </div>
    </form>

    <!-- Search and Filter -->
    <div class="mb-6">
      <input type="text" placeholder="Search by name or branch..." oninput="renderProfiles()" id="searchInput" class="w-full p-2 rounded border" />
    </div>

    <!-- Profiles Display -->
    <h2 class="text-xl font-semibold mb-2">All Profiles</h2>
    <div id="profiles" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
  </div>

  <script>
    let currentUser = localStorage.getItem('currentUser') || null;
    let users = JSON.parse(localStorage.getItem('users')) || [];
    let currentRole = localStorage.getItem('currentRole') || 'student';

    const loginSection = document.getElementById('loginSection');
    const studentForm = document.getElementById('studentForm');
    const staffForm = document.getElementById('staffForm');
    const profilesContainer = document.getElementById('profiles');
    const searchInput = document.getElementById('searchInput');

    if (currentUser) {
      loginSection.style.display = 'none';
      if (currentRole === 'staff') {
        staffForm.classList.remove('hidden');
        populateStaffForm();
      } else {
        studentForm.classList.remove('hidden');
        populateStudentForm();
      }
      renderProfiles();
    }

    function loginUser() {
      const name = document.getElementById('loginName').value.trim();
      const role = document.getElementById('userRole').value;

      if (!name) return alert("Please enter your full name");
      if (role === 'student' && name.split(" ").length < 3) {
        return alert("Students must enter full name in 'Name Father's Name Surname' format");
      }

      currentUser = name;
      currentRole = role;
      localStorage.setItem('currentUser', name);
      localStorage.setItem('currentRole', role);

      loginSection.style.display = 'none';
      if (role === 'staff') {
        staffForm.classList.remove('hidden');
        populateStaffForm();
      } else {
        studentForm.classList.remove('hidden');
        populateStudentForm();
      }
      renderProfiles();
    }

    function logoutUser() {
      localStorage.removeItem('currentUser');
      localStorage.removeItem('currentRole');
      location.reload();
    }

    function populateStudentForm() {
      const u = users.find(u => u.name === currentUser);
      if (u) {
        document.getElementById('year').value = u.year;
        document.getElementById('division').value = u.division;
        document.getElementById('roll').value = u.roll;
        document.getElementById('contact').value = u.contact;
        document.getElementById('interests').value = u.interests.join(', ');
        document.getElementById('expertise').value = u.expertise;
        document.getElementById('experience').value = u.experience;
        document.getElementById('mother').value = u.mother;
        document.getElementById('branch').value = u.branch;
      }
    }

    function populateStaffForm() {
      const u = users.find(u => u.name === currentUser);
      if (u) {
        document.getElementById('staffExpertise').value = u.expertise;
        document.getElementById('fieldResearch').value = u.research;
        document.getElementById('sittingLocation').value = u.location;
        document.getElementById('staffPhone').value = u.phone;
        document.getElementById('staffDept').value = u.department;
      }
    }

    studentForm.addEventListener('submit', function(e) {
      e.preventDefault();
      const user = {
        name: currentUser,
        role: 'student',
        year: document.getElementById('year').value,
        division: document.getElementById('division').value,
        roll: document.getElementById('roll').value,
        contact: document.getElementById('contact').value,
        interests: document.getElementById('interests').value.toLowerCase().split(',').map(i => i.trim()),
        expertise: document.getElementById('expertise').value,
        experience: document.getElementById('experience').value,
        mother: document.getElementById('mother').value,
        branch: document.getElementById('branch').value
      };
      saveUser(user);
    });

    staffForm.addEventListener('submit', function(e) {
      e.preventDefault();
      const user = {
        name: currentUser,
        role: 'staff',
        expertise: document.getElementById('staffExpertise').value,
        research: document.getElementById('fieldResearch').value,
        location: document.getElementById('sittingLocation').value,
        phone: document.getElementById('staffPhone').value,
        department: document.getElementById('staffDept').value
      };
      saveUser(user);
    });

    function saveUser(user) {
      const index = users.findIndex(u => u.name === currentUser);
      if (index >= 0) users[index] = user;
      else users.push(user);

      localStorage.setItem('users', JSON.stringify(users));
      renderProfiles();
    }

    function deleteUser(name) {
      users = users.filter(u => u.name !== name);
      localStorage.setItem('users', JSON.stringify(users));
      renderProfiles();
    }

    function renderProfiles() {
      const filter = searchInput.value.toLowerCase();
      profilesContainer.innerHTML = '';
      users.filter(u => u.name.toLowerCase().includes(filter) || (u.branch || u.department || '').toLowerCase().includes(filter))
        .forEach(user => {
          const card = document.createElement('div');
          card.className = `p-4 rounded shadow ${user.role === 'staff' ? 'bg-yellow-100' : 'bg-white'}`;

          let content = `<h3 class="text-lg font-bold">${user.name}</h3>`;

          if (user.role === 'student') {
            content += `
              <p><strong>Year:</strong> ${user.year}</p>
              <p><strong>Division:</strong> ${user.division}</p>
              <p><strong>Roll No:</strong> ${user.roll}</p>
              <p><strong>Contact:</strong> ${user.contact}</p>
              <p><strong>Interests:</strong> ${user.interests.join(', ')}</p>
              <p><strong>Expertise:</strong> ${user.expertise}</p>
              <p><strong>Experience:</strong> ${user.experience}</p>
              <p><strong>Mother's Name:</strong> ${user.mother}</p>
              <p><strong>Branch:</strong> ${user.branch}</p>`;
          } else {
            content += `
              <p><strong>Expertise:</strong> ${user.expertise}</p>
              <p><strong>Research:</strong> ${user.research}</p>
              <p><strong>Location:</strong> ${user.location}</p>
              <p><strong>Phone:</strong> ${user.phone}</p>
              <p><strong>Department:</strong> ${user.department}</p>`;
          }

          content += `<button onclick="deleteUser('${user.name}')" class="mt-2 bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600">Delete</button>`;
          card.innerHTML = content;
          profilesContainer.appendChild(card);
        });
    }
  </script>
</body>
</html>
