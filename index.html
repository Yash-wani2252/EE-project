<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>College Connect - KKWIEER</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">
  <div class="max-w-5xl mx-auto p-6">
    <!-- Intro Blog -->
    <section class="bg-white p-6 rounded shadow mb-8">
      <h1 class="text-3xl font-bold mb-4 text-purple-700 text-center">Welcome to College Connect - KKWIEER</h1>
      <p class="text-gray-700 text-lg leading-relaxed">
        College Connect is an initiative by students of <strong>KKWIEER</strong> to help peers and faculty interact,
        collaborate, and grow together. Whether you're a student finding project partners or a faculty member sharing
        your expertise, this platform lets you create a profile and discover others based on mutual interests, departments,
        and research domains. Let's build a stronger campus community, one connection at a time.
      </p>
    </section>

    <!-- Login -->
    <section id="loginSection" class="bg-white p-6 rounded shadow mb-8">
      <h2 class="text-2xl font-semibold mb-4 text-center">Login</h2>
      <select id="roleSelect" class="w-full p-2 border rounded mb-2">
        <option value="student">Student</option>
        <option value="staff">Staff</option>
      </select>
      <input type="text" id="fullName" placeholder="Full Name (Name Father's Name Surname)" class="w-full p-2 border rounded mb-2">
      <input type="text" id="fatherName" placeholder="Father's Name (optional for staff)" class="w-full p-2 border rounded mb-2">
      <button onclick="loginUser()" class="bg-green-500 text-white px-4 py-2 rounded w-full hover:bg-green-600">Login</button>
    </section>

    <!-- Profile Form -->
    <form id="profileForm" class="bg-white p-6 rounded shadow mb-6 hidden">
      <div id="studentFields" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
        <input type="text" placeholder="Mother's Name" id="motherName" class="border p-2 rounded">
        <input type="text" placeholder="Branch (Civil Engineering / Computer Engineering)" id="branch" class="border p-2 rounded">
        <input type="text" placeholder="Year" id="year" class="border p-2 rounded">
        <input type="text" placeholder="Division" id="division" class="border p-2 rounded">
        <input type="text" placeholder="Roll No" id="roll" class="border p-2 rounded">
        <input type="text" placeholder="Contact No" id="contact" class="border p-2 rounded">
        <input type="text" placeholder="Interests (comma separated)" id="interests" class="border p-2 rounded">
        <input type="text" placeholder="Expertise" id="expertise" class="border p-2 rounded">
        <input type="text" placeholder="Experience" id="experience" class="border p-2 rounded">
      </div>

      <div id="staffFields" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4 hidden">
        <input type="text" placeholder="Expertise" id="staffExpertise" class="border p-2 rounded">
        <input type="text" placeholder="Field of Research" id="research" class="border p-2 rounded">
        <input type="text" placeholder="Sitting Location" id="location" class="border p-2 rounded">
        <input type="text" placeholder="Department" id="department" class="border p-2 rounded">
        <input type="text" placeholder="Phone Number" id="staffContact" class="border p-2 rounded">
      </div>

      <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Save</button>
      <button type="button" onclick="logoutUser()" class="ml-4 bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">Logout</button>
    </form>

    <!-- Search Bar -->
    <input type="text" id="searchInput" placeholder="Search by name, branch or department" class="w-full p-2 border rounded mb-4">

    <!-- Profiles -->
    <div id="profiles" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
  </div>

  <script>
    const loginSection = document.getElementById('loginSection');
    const profileForm = document.getElementById('profileForm');
    const profilesContainer = document.getElementById('profiles');
    const roleSelect = document.getElementById('roleSelect');
    const studentFields = document.getElementById('studentFields');
    const staffFields = document.getElementById('staffFields');

    let currentUser = JSON.parse(localStorage.getItem('currentUser')) || null;
    let users = JSON.parse(localStorage.getItem('users')) || [];

    function loginUser() {
      const role = roleSelect.value;
      const name = document.getElementById('fullName').value.trim();
      const fatherName = document.getElementById('fatherName').value.trim();
      if (!name) return alert("Please enter your full name");

      currentUser = { name, role, fatherName };
      localStorage.setItem('currentUser', JSON.stringify(currentUser));

      loginSection.style.display = 'none';
      profileForm.classList.remove('hidden');

      if (role === 'student') {
        studentFields.classList.remove('hidden');
        staffFields.classList.add('hidden');
      } else {
        studentFields.classList.add('hidden');
        staffFields.classList.remove('hidden');
      }

      populateForm();
      renderProfiles();
    }

    function logoutUser() {
      localStorage.removeItem('currentUser');
      location.reload();
    }

    function populateForm() {
      if (!currentUser) return;
      const user = users.find(u => u.name === currentUser.name);
      if (!user) return;

      if (currentUser.role === 'student') {
        document.getElementById('motherName').value = user.motherName || '';
        document.getElementById('branch').value = user.branch || '';
        document.getElementById('year').value = user.year || '';
        document.getElementById('division').value = user.division || '';
        document.getElementById('roll').value = user.roll || '';
        document.getElementById('contact').value = user.contact || '';
        document.getElementById('interests').value = user.interests ? user.interests.join(', ') : '';
        document.getElementById('expertise').value = user.expertise || '';
        document.getElementById('experience').value = user.experience || '';
      } else {
        document.getElementById('staffExpertise').value = user.expertise || '';
        document.getElementById('research').value = user.research || '';
        document.getElementById('location').value = user.location || '';
        document.getElementById('department').value = user.department || '';
        document.getElementById('staffContact').value = user.contact || '';
      }
    }

    document.getElementById('profileForm').addEventListener('submit', function(e) {
      e.preventDefault();
      if (!currentUser) return;

      let user = { name: currentUser.name, role: currentUser.role };

      if (currentUser.role === 'student') {
        user = {
          ...user,
          motherName: document.getElementById('motherName').value,
          branch: document.getElementById('branch').value,
          year: document.getElementById('year').value,
          division: document.getElementById('division').value,
          roll: document.getElementById('roll').value,
          contact: document.getElementById('contact').value,
          interests: document.getElementById('interests').value.split(',').map(i => i.trim().toLowerCase()),
          expertise: document.getElementById('expertise').value,
          experience: document.getElementById('experience').value
        };
      } else {
        user = {
          ...user,
          expertise: document.getElementById('staffExpertise').value,
          research: document.getElementById('research').value,
          location: document.getElementById('location').value,
          department: document.getElementById('department').value,
          contact: document.getElementById('staffContact').value
        };
      }

      const index = users.findIndex(u => u.name === currentUser.name);
      if (index >= 0) users[index] = user;
      else users.push(user);

      localStorage.setItem('users', JSON.stringify(users));
      renderProfiles();
    });

    function renderProfiles(filter = '') {
      profilesContainer.innerHTML = '';
      users.filter(user => user.name.toLowerCase().includes(filter) || (user.branch || '').toLowerCase().includes(filter) || (user.department || '').toLowerCase().includes(filter)).forEach(user => {
        const card = document.createElement('div');
        card.className = `p-4 rounded shadow ${user.role === 'staff' ? 'bg-yellow-100' : 'bg-white'}`;

        let innerHTML = `<h3 class="text-xl font-bold">${user.name}</h3>`;
        if (user.role === 'student') {
          innerHTML += `
            <p>Mother's Name: ${user.motherName}</p>
            <p>Branch: ${user.branch}</p>
            <p>Year: ${user.year}, Division: ${user.division}</p>
            <p>Roll No: ${user.roll}, Contact: ${user.contact}</p>
            <p>Interests: ${user.interests.join(', ')}</p>
            <p>Expertise: ${user.expertise}</p>
            <p>Experience: ${user.experience}</p>
          `;
        } else {
          innerHTML += `
            <p>Expertise: ${user.expertise}</p>
            <p>Research: ${user.research}</p>
            <p>Location: ${user.location}</p>
            <p>Department: ${user.department}</p>
            <p>Phone: ${user.contact}</p>
          `;
        }

        card.innerHTML = innerHTML;
        profilesContainer.appendChild(card);
      });
    }

    document.getElementById('searchInput').addEventListener('input', e => {
      renderProfiles(e.target.value.toLowerCase());
    });

    if (currentUser) {
      loginSection.style.display = 'none';
      profileForm.classList.remove('hidden');
      (currentUser.role === 'student' ? studentFields : staffFields).classList.remove('hidden');
      populateForm();
      renderProfiles();
    }
  </script>
</body>
</html>
